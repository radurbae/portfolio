---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { CASE_STUDIES } from "@/data/portfolio-data";
import { toPage } from "@/utils/paths";

export function getStaticPaths() {
  return CASE_STUDIES.map((study) => ({
    params: { slug: study.slug },
    props: { study }
  }));
}

const { study } = Astro.props;
const currentIndex = CASE_STUDIES.findIndex((item) => item.slug === study.slug);
const previousStudy = currentIndex > 0 ? CASE_STUDIES[currentIndex - 1] : null;
const nextStudy = currentIndex < CASE_STUDIES.length - 1 ? CASE_STUDIES[currentIndex + 1] : null;
---

<BaseLayout title={study.title} description={study.summary}>
  <article class="px-6 py-8 md:px-10 md:py-12">
    <a href={toPage("/work")} data-i18n="caseStudy.backToWork" class="pill-button motion-press mb-4 w-fit">Back to Work</a>

    <p data-reveal data-i18n="caseStudy.badge" class="motion-reveal inline-flex rounded-full border border-[#c8c5ba] bg-white px-3 py-1 text-xs font-semibold">
      Case Study
    </p>
    <h1 data-reveal style="--reveal-delay:80ms" class="motion-reveal mt-4 max-w-[840px] text-4xl font-semibold leading-tight md:text-6xl">
      {study.title}
    </h1>
    <p data-reveal style="--reveal-delay:120ms" class="motion-reveal mt-3 max-w-[820px] text-sm text-[#4c4c4c] md:text-base">{study.tagline}</p>
    <p data-reveal style="--reveal-delay:160ms" class="motion-reveal mt-3 max-w-[820px] text-sm text-[#4c4c4c] md:text-base">{study.summary}</p>

    <div data-reveal style="--reveal-delay:210ms" class="motion-reveal mt-6 grid grid-cols-2 gap-3 md:grid-cols-4">
      <div class="motion-card rounded-2xl border border-[#d9d7ce] bg-white p-4">
        <p data-i18n="caseStudy.category" class="text-xs uppercase tracking-[0.08em] text-[#5a5a5a]">Category</p>
        <p class="mt-2 text-lg font-semibold">{study.category}</p>
      </div>
      <div class="motion-card rounded-2xl border border-[#d9d7ce] bg-white p-4">
        <p data-i18n="caseStudy.industry" class="text-xs uppercase tracking-[0.08em] text-[#5a5a5a]">Industry</p>
        <p class="mt-2 text-lg font-semibold">{study.industry}</p>
      </div>
      <div class="motion-card rounded-2xl border border-[#d9d7ce] bg-white p-4">
        <p data-i18n="caseStudy.timeline" class="text-xs uppercase tracking-[0.08em] text-[#5a5a5a]">Timeline</p>
        <p class="mt-2 text-lg font-semibold">{study.timeline}</p>
      </div>
      <div class="motion-card rounded-2xl border border-[#d9d7ce] bg-white p-4">
        <p data-i18n="caseStudy.role" class="text-xs uppercase tracking-[0.08em] text-[#5a5a5a]">Role</p>
        <p class="mt-2 text-base font-semibold">{study.role}</p>
      </div>
    </div>

    <section data-reveal class="motion-reveal motion-card mt-8 rounded-2xl border border-[#d9d7ce] bg-white p-5">
      <h2 data-i18n="caseStudy.challenge" class="text-xl font-semibold">Challenge</h2>
      <p class="mt-3 text-sm leading-relaxed text-[#4c4c4c] md:text-base">{study.challenge}</p>
    </section>

    <section data-reveal class="motion-reveal motion-card mt-5 rounded-2xl border border-[#d9d7ce] bg-white p-5">
      <h2 data-i18n="caseStudy.approach" class="text-xl font-semibold">Approach</h2>
      <ul class="mt-3 space-y-2 text-sm leading-relaxed text-[#4c4c4c] md:text-base">
        {study.approach.map((point) => <li>â€¢ {point}</li>)}
      </ul>
    </section>

    <section data-reveal class="motion-reveal motion-card mt-5 rounded-2xl border border-[#d9d7ce] bg-white p-5">
      <h2 data-i18n="caseStudy.deliverables" class="text-xl font-semibold">Deliverables</h2>
      <div class="mt-3 flex flex-wrap gap-2">
        {
          study.deliverables.map((item) => (
            <span class="rounded-full border border-[#c8c5ba] bg-[#f8f8f6] px-3 py-1 text-xs">{item}</span>
          ))
        }
      </div>
    </section>

    <section data-reveal class="motion-reveal mt-5 rounded-2xl border border-[#d9d7ce] bg-white p-5">
      <h2 data-i18n="caseStudy.outcomes" class="text-xl font-semibold">Outcomes</h2>
      <div class="mt-4 grid grid-cols-1 gap-3 md:grid-cols-3">
        {
          study.outcomes.map((outcome) => (
            <article class="motion-card rounded-xl border border-[#e2e0d8] bg-[#faf9f6] p-4">
              <p class="text-xs uppercase tracking-[0.08em] text-[#5a5a5a]">{outcome.label}</p>
              <p class="mt-2 text-2xl font-semibold">{outcome.value}</p>
              <p class="mt-2 text-xs leading-relaxed text-[#5a5a5a]">{outcome.detail}</p>
            </article>
          ))
        }
      </div>
    </section>

    <section data-reveal class="motion-reveal motion-card mt-5 rounded-2xl border border-[#d9d7ce] bg-white p-5">
      <h2 data-i18n="caseStudy.stack" class="text-xl font-semibold">Stack</h2>
      <div class="mt-3 flex flex-wrap gap-2">
        {
          study.stack.map((item) => (
            <span class="rounded-full border border-[#c8c5ba] bg-[#f8f8f6] px-3 py-1 text-xs">{item}</span>
          ))
        }
      </div>
    </section>

    <section data-reveal class="motion-reveal mt-5 flex flex-wrap gap-2">
      <a href={toPage("/contact")} data-i18n="caseStudy.requestBreakdown" class="primary-button motion-press">Request Full Breakdown</a>
      {
        study.links.live !== "#" && (
          <a href={study.links.live} target="_blank" rel="noreferrer" data-i18n="caseStudy.livePreview" class="pill-button motion-press px-4 py-2 text-sm">
            Live Preview
          </a>
        )
      }
    </section>

    <section data-reveal class="motion-reveal motion-card mt-8 rounded-2xl border border-[#d9d7ce] bg-white p-4">
      <div class="flex flex-wrap items-center justify-between gap-2">
        {
          previousStudy ? (
            <a href={toPage(`/work/${previousStudy.slug}`)} class="pill-button motion-press px-4 py-2 text-sm">
              <span data-i18n="caseStudy.previous">Previous</span>: {previousStudy.title}
            </a>
          ) : (
            <span data-i18n="caseStudy.start" class="text-xs text-[#5a5a5a]">Start of case studies</span>
          )
        }
        {
          nextStudy ? (
            <a href={toPage(`/work/${nextStudy.slug}`)} class="pill-button motion-press px-4 py-2 text-sm">
              <span data-i18n="caseStudy.next">Next</span>: {nextStudy.title}
            </a>
          ) : (
            <span data-i18n="caseStudy.end" class="text-xs text-[#5a5a5a]">End of case studies</span>
          )
        }
      </div>
    </section>
  </article>
</BaseLayout>
